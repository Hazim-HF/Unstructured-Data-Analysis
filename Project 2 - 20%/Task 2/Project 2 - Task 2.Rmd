---
title: "Project 2 - Task 2"
author: "Hazim Fitri P152419"
date: "`r Sys.Date()`"
output: 
  pdf_document:
    toc: true
    toc_depth: 6
---

```{r}
library(seewave)
library(rpanel)
library(tuneR)
```

```{r}
# upload data of a lion roar
lion = readMP3('Data/lion_roar.mp3')
str(lion)
```

```{r}
plot.frequency.spectrum <- function(X.k, xlimits=c(0,length(X.k))) {
  plot.data <- cbind(0:(length(X.k)-1), Mod(X.k))

  # TODO: why this scaling is necessary?
  plot.data[2:length(X.k),2] <- 2*plot.data[2:length(X.k),2]

  plot(plot.data, t="h", lwd=2, main="",
       xlab="Frequency (Hz)", ylab="Strength",
       xlim=xlimits, ylim=c(0,max(Mod(plot.data[,2]))))
}
```

```{r}
plot(lion)
```

```{r}
timer(lion, f=22050, threshold=5, msmooth=c(100,0))
```

```{r}
lion_r = fft(lion@left)  
plot.frequency.spectrum(lion_r)
```

```{r}
dynspec(lion, wl=1024, osc=T)
```

```{r}
spectro(lion)
```

```{r}
meanspec(lion)
```

# Crying Man Audio

```{r}
# upload data of a crying man
cry = readMP3('Data/crying_man.mp3')
str(cry)
```

```{r}
plot(cry)
```

```{r}
timer(cry, f=22050, threshold = 5, msmooth = c(100,0))
```

```{r}
cry_m = fft(cry@left)
plot.frequency.spectrum(cry_m)
```

```{r}
dynspec(cry)
```

```{r}
spectro(cry)
```

```{r}
meanspec(cry)
```
